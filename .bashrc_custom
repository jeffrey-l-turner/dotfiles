#!/bin/bash
# Pre-configure or override your bashrc environment here:
# the following alias is for mac environment when version 7.4 has been downloaded:
if [ "${OS}" == "darwin" ]; then # on MacOS change current directory to Finder dir
    # alias restartGoogleDrive=' killall -v -SIGKILL Google Driv; eopen -a Google Drive;'
    alias restartOneDrive=' killall -v -SIGKILL OneDriv; eopen -a OneDrive;'
    export PATH="/Applications/Xcode.app/Contents/Applications/Application Loader.app/Contents/Frameworks/ITunesSoftwareService.framework/Support:${PATH}" # adding altool to path
fi
alias gitPush='$(git push 2>&1 >/dev/null | grep git)'
alias gitCurrBranch="git branch | grep ^\\* | sed -e 's/^* //'"

alias jsb='js-beautify -w 120 -pc " " -s 4 -r' # alias to beautify using my prefs

export ANDROID_HOME=$HOME/Library/Android/sdk
export PATH=$PATH:$ANDROID_HOME/tools:$ANDROID_HOME/tools/bin:$ANDROID_HOME/platform-tools

function _concatToEternalHist() {
    local last recent linenum
    last=$(grep -Fn "$(tail -1 ~/OneDrive/Bash_eternal_hist | cut -f 5 | cut -d ' ' -f 4)" ~/OneDrive/Bash_eternal_hist  | sed s/:.*$//)
    recent=$(wc -l ~/.bash_eternal_history | sed 's/ \/.*//' | sed 's/^ *//')
    # shellcheck disable=SC2219
    let linenum="${recent} - ${last}"
    tail -n "${linenum}" ~/.bash_eternal_history >> ~/OneDrive/Bash_eternal_hist
}

function mergeEternalHist() {
    rm -f /tmp/Bash_eternal_hist
    _concatToEternalHist 
    sort -n --key=8 ~/OneDrive/Bash_eternal_hist  | LC_ALL=C uniq > /tmp/Bash_eternal_hist
    cp -i /tmp/Bash_eternal_hist ~/OneDrive/Bash_eternal_hist  
    mv -i /tmp/Bash_eternal_hist ~/.bash_eternal_history 
}

export PATH="/Library/Frameworks/Python.framework/Versions/2.7/bin:/Library/Frameworks/Python.framework/Versions/3.7/bin:${PATH}"

if [ -e /Users/jeff/.nix-profile/etc/profile.d/nix.sh ]; then . /Users/jeff/.nix-profile/etc/profile.d/nix.sh; fi
export PowerLineFonts="${HOME}/.config/fontconfig/conf.d/50-enable-terminess-powerline.conf"
if [[ -f "$PowerLineFonts" ]]; then
  DEFAULT_USER=$(whoami)
  export DEFAULT_USER;
  # shellcheck disable=SC1090
  source "${HOME}/dotfiles/PowerLine.sh"
fi

function FFOW() {
    local QU="find . -type f -exec grep -nHi $1 {} \\;" 
    shift
    for GR in "$@"
    do
        QU="${QU} | grep -i ${GR}"
    done
    echo "${QU} | grep -v node_modules/ | grep -v commerce/ | grep -v ios/ | grep -v android/ | grep -v public/" >&2 
    eval "${QU}" | grep -v node_modules/ | grep -v commerce/ | grep -v ios/ | grep -v android/ | grep -v public/
}

if [ "${TERM_PROGRAM}" == "iTerm.app" ]; then
   # shellcheck disable=SC1090
  test -e "${HOME}/.iterm2_shell_integration.bash" && source "${HOME}/.iterm2_shell_integration.bash"
fi
